if(typeof(mlog)==="undefined"){var mlog=function(){}}mlog.dialog={};$.extend(mlog.dialog,{tip:function(a){$.dialog({title:false,content:a,time:1,min:false,max:false,icon:"error.gif",close:function(){var f=400,d=this,b=d.config,c=d.DOM.wrap,e=$(window).scrollTop()-c[0].offsetHeight;c.animate({top:e+"px",opacity:0},f,function(){b.close=$.noop;d.close()});return false}})},showModelDialog:function(a){return $.dialog({title:a.title,content:a.content,lock:a.lock===undefined?true:a.lock,button:a.button,width:a.width,height:a.height,max:a.max,min:a.min})}});if(typeof(mlog)==="undefined"){var mlog=function(){}}mlog.editor={};mlog.editor.ins={};mlog.editor.ins.createPostEditor={};mlog.editor.ins.createPostSummaryEditor={};mlog.editor.ins.editPostEditor={};mlog.editor.ins.editPostSummaryEditor={};$.extend(mlog.editor,{init:function(b){if(b.type!="kindeditor"&&b.type!="tinymce"){b.type="kindeditor"}if(b.model!="all"&&b.model!="simple"){b.model="all"}if(b.type===undefined){b.type="kindeditor"}if(b.model===undefined){b.model="all"}if(b.type==="kindeditor"){var a=null;if(typeof(KindEditor)==="undefined"){a=mlog.utils.loader.loadJavaScript(mlog.variable.base+"/script/kindeditor/kindeditor.js",function(){mlog.editor.KindEditor.init({model:b.model,id:b.id,fun:b.fun,width:b.width,height:b.height,language:b.language})})}else{a=mlog.editor.KindEditor.init({model:b.model,id:b.id,fun:b.fun,width:b.width,height:b.height,language:b.language})}return a}else{if(b.type==="tinymce"){if(typeof(tinyMCE)==="undefined"){mlog.utils.loader.loadJavaScript(mlog.variable.base+"/script/tinymce/tiny_mce.js",function(){mlog.editor.TinyMCE.init({model:b.model,id:b.id,fun:b.fun,width:b.width,height:b.height,language:b.language})})}else{mlog.editor.TinyMCE.init({model:b.model,id:b.id,fun:b.fun,width:b.width,height:b.height,language:b.language})}}else{}}}});mlog.editor.KindEditor={};$.extend(mlog.editor.KindEditor,{init:function(a){if(typeof(KindEditor)==="undefined"){return}if(a.language===undefined){a.language="zh_CN"}if(a.model===undefined){a.model="all"}if(a.model==="all"){this[a.id]=KindEditor.create("#"+a.id,{langType:a.language,width:a.width,height:a.height,uploadJson:mlog.variable.base+"/admin/attachment/upload",items:["formatblock","fontname","fontsize","|","bold","italic","underline","strikethrough","forecolor","|","link","unlink","pagebreak","|","emoticons","image","flash","media","code","fullscreen","/","undo","redo","|","insertunorderedlist","insertorderedlist","indent","outdent","|","justifyleft","justifycenter","justifyright","justifyfull","|","plainpaste","wordpaste","|","clearhtml","source","preview"],afterCreate:function(){this.sync();if(typeof(a.fun)==="function"){a.fun()}},afterChange:function(){this.sync()}})}else{if(a.model==="simple"){this[a.id]=KindEditor.create("#"+a.id,{langType:a.language,width:a.width,height:a.height,resizeType:0,items:["bold","italic","underline","strikethrough","|","undo","redo","|","insertunorderedlist","insertorderedlist","|","emoticons"],afterCreate:function(){this.sync();if(typeof(a.fun)==="function"){a.fun()}},afterChange:function(){this.sync()}})}}return this[a.id]},getHtmlContent:function(a){var b="";try{b=this[a].html()}catch(c){b=$("#"+a).val()}return b},setHtmlContent:function(a,b){try{this[a].html(b)}catch(c){$("#"+a).val(b)}}});mlog.editor.TinyMCE={};$.extend(mlog.editor.TinyMCE,{init:function(a){if(typeof(tinyMCE)==="undefined"){return}if(a.language===undefined){a.language="zh-cn"}if(a.model===undefined){a.model="all"}if(a.model==="all"){tinyMCE.init({language:a.language,mode:"exact",elements:a.id,theme:"advanced",plugins:"autosave,style,advhr,advimage,advlink,preview,inlinepopups,media,paste,fullscreen,syntaxhl",theme_advanced_buttons1:"forecolor,backcolor,|,bold,italic,underline,strikethrough,|,justifyleft,justifycenter,justifyright,justifyfull,formatselect,fontselect,fontsizeselect",theme_advanced_buttons2:"bullist,numlist,outdent,indent,|,undo,redo,|,sub,sup,blockquote,charmap,image,iespell,media,|,advhr,link,unlink,anchor,cleanup,|,pastetext,pasteword,code,preview,fullscreen,syntaxhl",theme_advanced_buttons3:"",theme_advanced_toolbar_location:"top",theme_advanced_toolbar_align:"left",theme_advanced_resizing:true,theme_advanced_statusbar_location:"bottom",extended_valid_elements:"pre[name|class],iframe[src|width|height|name|align]",valid_children:"+body[style]",relative_urls:false,remove_script_host:false,oninit:function(){if(typeof(a.fun)==="function"){a.fun()}},onchange_callback:function(){tinyMCE.triggerSave()}})}else{if(a.model==="simple"){tinyMCE.init({language:a.language,mode:"exact",elements:a.id,theme:"advanced",theme_advanced_buttons1:"bold,italic,underline,strikethrough,|,undo,redo,|,bullist,numlist",theme_advanced_buttons2:"",theme_advanced_buttons3:"",theme_advanced_toolbar_location:"top",theme_advanced_toolbar_align:"left",valid_children:"+body[style]"})}}}});if(typeof(mlog)==="undefined"){var mlog=function(){}}mlog.form={};$.extend(mlog.form,{checkAll:function(d,b){var c=document.getElementsByName(b);
for(var a=0;a<c.length;a++){c[a].checked=d.checked}},checkThis:function(e,c){var d=document.getElementsByName(c);var b=0;for(var a=0;a<d.length;a++){if(d[a].checked){b++}if(b>=2){return}}return e.value},submitForm:function(c,b){var a=document.getElementById(c);if(b){a.action=b}a.submit()},confirmSubmit:function(d,b,c){var a="确认删除选择项吗？";if(c){a=c}if(confirm(a)){mlog.form.submitForm(d,b)}},validate:function(a){if(a===undefined||a.selector===undefined){return}if(a.onfocusout===undefined){a.onfocusout=false}if(a.onkeyup===undefined){a.onkeyup=false}if(a.onclick===undefined){a.onclick=false}$.metadata.setType("attr","validate");$(a.selector).validate({success:a.success,errorLabelContainer:$(a.errorLabelContainer),wrapper:a.wrapper,onfocusout:a.onfocusout,onkeyup:a.onkeyup,onclick:a.onclick,showErrors:a.showErrors})}});if(typeof(mlog)==="undefined"){var mlog=function(){}}mlog.stat={};$.extend(mlog.stat,{postClick:function(a){if(!a){return}$.get(mlog.variable.base+"/script/stat?cmd=post_click&post_id="+a)},blogClick:function(){$.get(mlog.variable.base+"/script/stat?cmd=blog_click")}});if(typeof(mlog)==="undefined"){var mlog=function(){}}mlog.utils={};$.extend(mlog.utils,{getWebRootPath:function(){var b=location.href;var a=b.split("/");return a[0]+"//"+a[2]+"/"+a[3]},getXMLHttpRequest:function(){if(window.XMLHttpRequest){return new XMLHttpRequest()}else{if(window.ActiveXObject){return new ActiveXObject("Microsoft.XMLHTTP")}}},getCookie:function(b){var a=document.cookie.match(new RegExp("(^| )"+b+"=([^;]*)(;|$)"));if(a!=null){return unescape(a[2])}return null},setCookie:function(c,d,a){if(a){var b=new Date();b.setTime(b.getTime()+parseInt(a*24*60*60*1000));document.cookie=c+"="+escape(d)+"; expires="+b.toGMTString()+"; path=/"}else{document.cookie=c+"="+escape(d)+"; path=/"}},scrollTop:function(){var b=b||0.1;var d=$(window).scrollTop();var c=1+b;window.scrollTo(0,Math.floor(d/c));if(d>0){var a="mlog.utils.scrollTop("+b+")";window.setTimeout(a,16)}}});mlog.utils.loader={};$.extend(mlog.utils.loader,{loadJavaScript:function(c,d){try{var a=document.createElement("script");a.src=c;a.type="text/javascript";document.getElementsByTagName("head")[0].appendChild(a);if(a.addEventListener){a.addEventListener("load",d,false)}else{if(a.attachEvent){a.attachEvent("onreadystatechange",function(){if(a.readyState==4||a.readyState=="complete"||a.readyState=="loaded"){d()}})}}}catch(b){d()}},loadStyleSheet:function(a){if(document.createStyleSheet){return document.createStyleSheet(a)}else{$("head").append($("<link rel='stylesheet' href='"+a+"' type='text/css' charset='utf-8' />"))}},loadJavaScriptByAjax:function(a){if(a===undefined||a.url===undefined){return}if(a.async===undefined){a.async=false}$.ajax({url:a.url,dataType:"script",async:a.async,cache:true,success:a.success})}});String.prototype.startWith=function(a){if(a==null||a==""||this.length==0||a.length>this.length){return false}if(this.substr(0,a.length)==a){return true}else{return false}return true};String.prototype.endWith=function(a){if(a==null||a==""||this.length==0||a.length>this.length){return false}if(this.substring(this.length-a.length)==a){return true}else{return false}return true};